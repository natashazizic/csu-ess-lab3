[
  {
    "objectID": "Lab03.html",
    "href": "Lab03.html",
    "title": "Lab 3: Covid-19",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(flextable)\n\n\nAttaching package: 'flextable'\n\nThe following object is masked from 'package:purrr':\n\n    compose\n\nlibrary(zoo) \n\n\nAttaching package: 'zoo'\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\nQuestion 1:\n\nurl = 'https://raw.githubusercontent.com/nytimes/covid-19-data/master/us-counties.csv'\ncovid = read.csv(url)\nhead(covid, 5)\n\n        date    county      state  fips cases deaths\n1 2020-01-21 Snohomish Washington 53061     1      0\n2 2020-01-22 Snohomish Washington 53061     1      0\n3 2020-01-23 Snohomish Washington 53061     1      0\n4 2020-01-24      Cook   Illinois 17031     1      0\n5 2020-01-24 Snohomish Washington 53061     1      0\n\n\nHow does easy access to historical and real-time environmental data shape our understanding of climate trends, resource management, and public health? What happens when this data disappears or becomes inaccessible?\nEasy access to historical and current data has dramatically improved our knowledge of these topics. Since we are able to see the data over time, it is much easier to understand how things have changed over time as well as the current state of things. Unfortunately, we are so reliant on this data that when it becomes inaccessible, it can have negative consequences. For example, when data is not regularly updated, but people are expecting updated information, it is much more likely that there will be a spread of misinformation.\nQuestion 2:\n\nmy.date &lt;- as.Date(\"2022-02-01\")\nmy.state &lt;- \"Colorado\"\n\n\nco_data &lt;- covid |&gt;\n  filter(state == my.state)|&gt;\n  group_by(county) |&gt;\n  arrange(date) |&gt;\n  mutate(new_cases = cases - lag(cases, default = first(cases)),\n         new_deaths = deaths - lag(deaths, default = first(deaths))) |&gt;\n  ungroup()\n\n\nlatest_data &lt;- co_data |&gt;\n  filter(date == my.date)\n\n\ntop5_cumulative &lt;- latest_data |&gt;\n  arrange(desc(cases)) |&gt;\n  slice(1:5) |&gt;\n  select(county, cases)\n\ntop5_new_cases &lt;- latest_data |&gt;\n  arrange(desc(new_cases)) |&gt;\n  slice(1:5) |&gt;\n  select(county, new_cases)\n\n\nsafe_counties &lt;- latest_data |&gt;\n  filter(new_cases &lt; 100) |&gt;\n  select(county)\n\n\ntotal_new_cases &lt;- sum(latest_data$new_cases, na.rm = TRUE)\ntotal_cumulative_cases &lt;- sum(latest_data$cases, na.rm = TRUE)\nnum_safe_counties &lt;- nrow(safe_counties)\n\n\nknitr::kable(top5_cumulative, caption = \"Top 5 Counties by Cumulative Cases\")\n\n\nTop 5 Counties by Cumulative Cases\n\n\ncounty\ncases\n\n\n\n\nEl Paso\n170673\n\n\nDenver\n159022\n\n\nArapahoe\n144255\n\n\nAdams\n126768\n\n\nJefferson\n113240\n\n\n\n\nknitr::kable(top5_new_cases, caption = \"Top 5 Counties by New Cases\")\n\n\nTop 5 Counties by New Cases\n\n\ncounty\nnew_cases\n\n\n\n\nEl Paso\n630\n\n\nArapahoe\n401\n\n\nDenver\n389\n\n\nAdams\n326\n\n\nJefferson\n291\n\n\n\n\nknitr::kable(safe_counties, caption = \"Counties Considered Safe\")\n\n\nCounties Considered Safe\n\n\ncounty\n\n\n\n\nAlamosa\n\n\nArchuleta\n\n\nBaca\n\n\nBent\n\n\nBroomfield\n\n\nChaffee\n\n\nCheyenne\n\n\nClear Creek\n\n\nConejos\n\n\nCostilla\n\n\nCrowley\n\n\nCuster\n\n\nDelta\n\n\nDolores\n\n\nEagle\n\n\nElbert\n\n\nFremont\n\n\nGarfield\n\n\nGilpin\n\n\nGrand\n\n\nGunnison\n\n\nHinsdale\n\n\nHuerfano\n\n\nJackson\n\n\nKiowa\n\n\nKit Carson\n\n\nLa Plata\n\n\nLake\n\n\nLas Animas\n\n\nLincoln\n\n\nLogan\n\n\nMineral\n\n\nMoffat\n\n\nMontezuma\n\n\nMontrose\n\n\nMorgan\n\n\nOtero\n\n\nOuray\n\n\nPark\n\n\nPhillips\n\n\nPitkin\n\n\nProwers\n\n\nRio Blanco\n\n\nRio Grande\n\n\nRoutt\n\n\nSaguache\n\n\nSan Juan\n\n\nSan Miguel\n\n\nSedgwick\n\n\nSummit\n\n\nTeller\n\n\nWashington\n\n\nYuma\n\n\n\n\n\nQuestion 3:\n\npop_url &lt;- 'https://www2.census.gov/programs-surveys/popest/datasets/2020-2023/counties/totals/co-est2023-alldata.csv'\npop_data &lt;- read_csv(pop_url)\n\nRows: 3195 Columns: 67\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (5): SUMLEV, STATE, COUNTY, STNAME, CTYNAME\ndbl (62): REGION, DIVISION, ESTIMATESBASE2020, POPESTIMATE2020, POPESTIMATE2...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhead(pop_data,5)\n\n# A tibble: 5 × 67\n  SUMLEV REGION DIVISION STATE COUNTY STNAME  CTYNAME        ESTIMATESBASE2020\n  &lt;chr&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;                      &lt;dbl&gt;\n1 040         3        6 01    000    Alabama Alabama                  5024294\n2 050         3        6 01    001    Alabama Autauga County             58809\n3 050         3        6 01    003    Alabama Baldwin County            231768\n4 050         3        6 01    005    Alabama Barbour County             25229\n5 050         3        6 01    007    Alabama Bibb County                22301\n# ℹ 59 more variables: POPESTIMATE2020 &lt;dbl&gt;, POPESTIMATE2021 &lt;dbl&gt;,\n#   POPESTIMATE2022 &lt;dbl&gt;, POPESTIMATE2023 &lt;dbl&gt;, NPOPCHG2020 &lt;dbl&gt;,\n#   NPOPCHG2021 &lt;dbl&gt;, NPOPCHG2022 &lt;dbl&gt;, NPOPCHG2023 &lt;dbl&gt;, BIRTHS2020 &lt;dbl&gt;,\n#   BIRTHS2021 &lt;dbl&gt;, BIRTHS2022 &lt;dbl&gt;, BIRTHS2023 &lt;dbl&gt;, DEATHS2020 &lt;dbl&gt;,\n#   DEATHS2021 &lt;dbl&gt;, DEATHS2022 &lt;dbl&gt;, DEATHS2023 &lt;dbl&gt;, NATURALCHG2020 &lt;dbl&gt;,\n#   NATURALCHG2021 &lt;dbl&gt;, NATURALCHG2022 &lt;dbl&gt;, NATURALCHG2023 &lt;dbl&gt;,\n#   INTERNATIONALMIG2020 &lt;dbl&gt;, INTERNATIONALMIG2021 &lt;dbl&gt;, …\n\n\n\npop_data &lt;- pop_data %&gt;%\n  mutate(\n    STATE = as.numeric(as.character(STATE)),  \n    COUNTY = as.numeric(as.character(COUNTY)),\n    STATE = sprintf(\"%02d\", STATE),  \n    COUNTY = sprintf(\"%03d\", COUNTY), \n    FIPS = paste0(STATE, COUNTY)\n  )\n\n\npop_data &lt;- pop_data |&gt;\n  filter(COUNTY != \"000\") |&gt;\n  select(FIPS, contains(\"NAME\"), contains(\"2021\"))\n\n\nglimpse(pop_data)\n\nRows: 3,144\nColumns: 19\n$ FIPS                  &lt;chr&gt; \"01001\", \"01003\", \"01005\", \"01007\", \"01009\", \"01…\n$ STNAME                &lt;chr&gt; \"Alabama\", \"Alabama\", \"Alabama\", \"Alabama\", \"Ala…\n$ CTYNAME               &lt;chr&gt; \"Autauga County\", \"Baldwin County\", \"Barbour Cou…\n$ POPESTIMATE2021       &lt;dbl&gt; 59203, 239439, 24533, 22359, 59079, 10143, 18890…\n$ NPOPCHG2021           &lt;dbl&gt; 288, 6212, -436, 171, -28, -86, -135, -565, -163…\n$ BIRTHS2021            &lt;dbl&gt; 686, 2337, 270, 240, 654, 111, 227, 1250, 392, 2…\n$ DEATHS2021            &lt;dbl&gt; 696, 2948, 390, 325, 875, 160, 297, 1843, 592, 4…\n$ NATURALCHG2021        &lt;dbl&gt; -10, -611, -120, -85, -221, -49, -70, -593, -200…\n$ INTERNATIONALMIG2021  &lt;dbl&gt; 15, 105, 0, 1, 9, 1, 5, 12, 22, 7, 20, 1, 0, -1,…\n$ DOMESTICMIG2021       &lt;dbl&gt; 242, 6972, -313, 254, 141, -42, -75, -70, -6, 28…\n$ NETMIG2021            &lt;dbl&gt; 257, 7077, -313, 255, 150, -41, -70, -58, 16, 29…\n$ RESIDUAL2021          &lt;dbl&gt; 41, -254, -3, 1, 43, 4, 5, 86, 21, 2, 18, 7, 8, …\n$ GQESTIMATES2021       &lt;dbl&gt; 484, 3351, 2248, 1994, 616, 1578, 285, 5407, 856…\n$ RBIRTH2021            &lt;dbl&gt; 11.615503, 9.888589, 10.908650, 10.775136, 11.06…\n$ RDEATH2021            &lt;dbl&gt; 11.78483, 12.47392, 15.75694, 14.59133, 14.80717…\n$ RNATURALCHG2021       &lt;dbl&gt; -0.1693222, -2.5853351, -4.8482890, -3.8161941, …\n$ RINTERNATIONALMIG2021 &lt;dbl&gt; 0.25398330, 0.44428836, 0.00000000, 0.04489640, …\n$ RDOMESTICMIG2021      &lt;dbl&gt; 4.0975973, 29.5007468, -12.6459537, 11.4036860, …\n$ RNETMIG2021           &lt;dbl&gt; 4.3515806, 29.9450352, -12.6459537, 11.4485824, …\n\n\n\nglimpse(co_data)\n\nRows: 49,527\nColumns: 8\n$ date       &lt;chr&gt; \"2020-03-05\", \"2020-03-05\", \"2020-03-06\", \"2020-03-06\", \"20…\n$ county     &lt;chr&gt; \"Douglas\", \"Jefferson\", \"Denver\", \"Douglas\", \"Eagle\", \"El P…\n$ state      &lt;chr&gt; \"Colorado\", \"Colorado\", \"Colorado\", \"Colorado\", \"Colorado\",…\n$ fips       &lt;int&gt; 8035, 8059, 8031, 8035, 8037, 8041, 8059, 8031, 8035, 8037,…\n$ cases      &lt;int&gt; 1, 1, 2, 3, 1, 1, 1, 2, 3, 1, 1, 1, 2, 3, 1, 1, 1, 1, 3, 3,…\n$ deaths     &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ new_cases  &lt;int&gt; 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0,…\n$ new_deaths &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n\n\nThe data has 19 columns and 3144 rows. There only a few columns similar to the covid data, including the state and the number of deaths, for example.\n\nrange(pop_data$POPESTIMATE2021, na.rm = TRUE)\n\n[1]      54 9809462\n\n\nThe range of populations in Colorado counties in 2021 is 54 to 9809462.\n\nco_data &lt;- co_data %&gt;% rename(FIPS = `fips`)\n\n\nco_data &lt;- co_data |&gt; mutate(FIPS = as.character(FIPS))\npop_data &lt;- pop_data |&gt; mutate(FIPS = as.character(FIPS))\n\n\nlibrary(tidyverse)\n\nco_data &lt;- co_data %&gt;%\n  mutate(FIPS = sprintf(\"%05d\", as.numeric(FIPS)))\n\npop_data &lt;- pop_data %&gt;%\n  mutate(FIPS = as.character(FIPS))\n\ncovid_pop_data &lt;- co_data %&gt;%\n  left_join(pop_data, by = \"FIPS\") %&gt;%\n  mutate(\n    per_capita_cases = cases / POPESTIMATE2021,\n    per_capita_new_cases = new_cases / POPESTIMATE2021,\n    per_capita_new_deaths = new_deaths / POPESTIMATE2021\n  )\n\nglimpse(covid_pop_data)\n\nRows: 49,527\nColumns: 29\n$ date                  &lt;chr&gt; \"2020-03-05\", \"2020-03-05\", \"2020-03-06\", \"2020-…\n$ county                &lt;chr&gt; \"Douglas\", \"Jefferson\", \"Denver\", \"Douglas\", \"Ea…\n$ state                 &lt;chr&gt; \"Colorado\", \"Colorado\", \"Colorado\", \"Colorado\", …\n$ FIPS                  &lt;chr&gt; \"08035\", \"08059\", \"08031\", \"08035\", \"08037\", \"08…\n$ cases                 &lt;int&gt; 1, 1, 2, 3, 1, 1, 1, 2, 3, 1, 1, 1, 2, 3, 1, 1, …\n$ deaths                &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ new_cases             &lt;int&gt; 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ new_deaths            &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ STNAME                &lt;chr&gt; \"Colorado\", \"Colorado\", \"Colorado\", \"Colorado\", …\n$ CTYNAME               &lt;chr&gt; \"Douglas County\", \"Jefferson County\", \"Denver Co…\n$ POPESTIMATE2021       &lt;dbl&gt; 369783, 580703, 711467, 369783, 55774, 737287, 5…\n$ NPOPCHG2021           &lt;dbl&gt; 9460, -2378, -6139, 9460, 117, 4903, -2378, -613…\n$ BIRTHS2021            &lt;dbl&gt; 3529, 5396, 8580, 3529, 518, 9301, 5396, 8580, 3…\n$ DEATHS2021            &lt;dbl&gt; 1899, 5402, 5138, 1899, 170, 5877, 5402, 5138, 1…\n$ NATURALCHG2021        &lt;dbl&gt; 1630, -6, 3442, 1630, 348, 3424, -6, 3442, 1630,…\n$ INTERNATIONALMIG2021  &lt;dbl&gt; 248, 225, 703, 248, 38, 53, 225, 703, 248, 38, 5…\n$ DOMESTICMIG2021       &lt;dbl&gt; 7759, -2960, -10331, 7759, -303, 911, -2960, -10…\n$ NETMIG2021            &lt;dbl&gt; 8007, -2735, -9628, 8007, -265, 964, -2735, -962…\n$ RESIDUAL2021          &lt;dbl&gt; -177, 363, 47, -177, 34, 515, 363, 47, -177, 34,…\n$ GQESTIMATES2021       &lt;dbl&gt; 1608, 9147, 13955, 1608, 99, 18304, 9147, 13955,…\n$ RBIRTH2021            &lt;dbl&gt; 9.667089, 9.273198, 12.007784, 9.667089, 9.29723…\n$ RDEATH2021            &lt;dbl&gt; 5.201984, 9.283510, 7.190675, 5.201984, 3.051216…\n$ RNATURALCHG2021       &lt;dbl&gt; 4.46510507, -0.01031119, 4.81710871, 4.46510507,…\n$ RINTERNATIONALMIG2021 &lt;dbl&gt; 0.67935341, 0.38666969, 0.98385457, 0.67935341, …\n$ RDOMESTICMIG2021      &lt;dbl&gt; 21.254448, -5.086855, -14.458324, 21.254448, -5.…\n$ RNETMIG2021           &lt;dbl&gt; 21.933801, -4.700185, -13.474469, 21.933801, -4.…\n$ per_capita_cases      &lt;dbl&gt; 2.704289e-06, 1.722051e-06, 2.811093e-06, 8.1128…\n$ per_capita_new_cases  &lt;dbl&gt; 0.000000e+00, 0.000000e+00, 0.000000e+00, 5.4085…\n$ per_capita_new_deaths &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n\n\n\nlibrary(flextable)\n\ntop_cumulative_cases &lt;- covid_pop_data %&gt;%\n  filter(date == \"2021-01-01\") %&gt;%\n  arrange(desc(per_capita_cases)) %&gt;%\n  slice_head(n = 5) %&gt;%\n  select(County = CTYNAME, 'Total Cases Per Capita' = per_capita_cases)\n\nflextable(top_cumulative_cases) %&gt;%\n  set_caption(\"Top 5 Counties with Most Cumulative Cases per Capita on 2021-01-01\")\n\nCountyTotal Cases Per CapitaCrowley County0.28945074Bent County0.21090092Logan County0.15467009Lincoln County0.14306596Fremont County0.09507078\n\n\n\ntop_new_cases &lt;- covid_pop_data %&gt;%\n  filter(date == \"2021-01-01\") %&gt;%\n  arrange(desc(per_capita_new_cases)) %&gt;%\n  slice_head(n = 5) %&gt;%\n  select(County = CTYNAME, `New Cases Per Capita` = per_capita_cases)\n\nflextable(top_new_cases) %&gt;%\n  set_caption(\"Top 5 Counties with Most New Cases per Capita on 2021-01-01\")\n\nCountyNew Cases Per CapitaBent County0.21090092Sedgwick County0.05760963Chaffee County0.05430323Crowley County0.28945074Mineral County0.04736276\n\n\nQuestion 4:\n\nlibrary(tidyverse)\n\ncovid_pop_data &lt;- covid_pop_data %&gt;%\n  mutate(date = as.Date(my.date))\n\nlast_14_days &lt;- covid_pop_data %&gt;%\n  filter(date &gt;= (max(date) - 14)) %&gt;%\n  glimpse()\n\nRows: 49,527\nColumns: 29\n$ date                  &lt;date&gt; 2022-02-01, 2022-02-01, 2022-02-01, 2022-02-01,…\n$ county                &lt;chr&gt; \"Douglas\", \"Jefferson\", \"Denver\", \"Douglas\", \"Ea…\n$ state                 &lt;chr&gt; \"Colorado\", \"Colorado\", \"Colorado\", \"Colorado\", …\n$ FIPS                  &lt;chr&gt; \"08035\", \"08059\", \"08031\", \"08035\", \"08037\", \"08…\n$ cases                 &lt;int&gt; 1, 1, 2, 3, 1, 1, 1, 2, 3, 1, 1, 1, 2, 3, 1, 1, …\n$ deaths                &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ new_cases             &lt;int&gt; 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ new_deaths            &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ STNAME                &lt;chr&gt; \"Colorado\", \"Colorado\", \"Colorado\", \"Colorado\", …\n$ CTYNAME               &lt;chr&gt; \"Douglas County\", \"Jefferson County\", \"Denver Co…\n$ POPESTIMATE2021       &lt;dbl&gt; 369783, 580703, 711467, 369783, 55774, 737287, 5…\n$ NPOPCHG2021           &lt;dbl&gt; 9460, -2378, -6139, 9460, 117, 4903, -2378, -613…\n$ BIRTHS2021            &lt;dbl&gt; 3529, 5396, 8580, 3529, 518, 9301, 5396, 8580, 3…\n$ DEATHS2021            &lt;dbl&gt; 1899, 5402, 5138, 1899, 170, 5877, 5402, 5138, 1…\n$ NATURALCHG2021        &lt;dbl&gt; 1630, -6, 3442, 1630, 348, 3424, -6, 3442, 1630,…\n$ INTERNATIONALMIG2021  &lt;dbl&gt; 248, 225, 703, 248, 38, 53, 225, 703, 248, 38, 5…\n$ DOMESTICMIG2021       &lt;dbl&gt; 7759, -2960, -10331, 7759, -303, 911, -2960, -10…\n$ NETMIG2021            &lt;dbl&gt; 8007, -2735, -9628, 8007, -265, 964, -2735, -962…\n$ RESIDUAL2021          &lt;dbl&gt; -177, 363, 47, -177, 34, 515, 363, 47, -177, 34,…\n$ GQESTIMATES2021       &lt;dbl&gt; 1608, 9147, 13955, 1608, 99, 18304, 9147, 13955,…\n$ RBIRTH2021            &lt;dbl&gt; 9.667089, 9.273198, 12.007784, 9.667089, 9.29723…\n$ RDEATH2021            &lt;dbl&gt; 5.201984, 9.283510, 7.190675, 5.201984, 3.051216…\n$ RNATURALCHG2021       &lt;dbl&gt; 4.46510507, -0.01031119, 4.81710871, 4.46510507,…\n$ RINTERNATIONALMIG2021 &lt;dbl&gt; 0.67935341, 0.38666969, 0.98385457, 0.67935341, …\n$ RDOMESTICMIG2021      &lt;dbl&gt; 21.254448, -5.086855, -14.458324, 21.254448, -5.…\n$ RNETMIG2021           &lt;dbl&gt; 21.933801, -4.700185, -13.474469, 21.933801, -4.…\n$ per_capita_cases      &lt;dbl&gt; 2.704289e-06, 1.722051e-06, 2.811093e-06, 8.1128…\n$ per_capita_new_cases  &lt;dbl&gt; 0.000000e+00, 0.000000e+00, 0.000000e+00, 5.4085…\n$ per_capita_new_deaths &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n\n\n\nrolling_cases &lt;- last_14_days %&gt;%\n  group_by(CTYNAME) %&gt;%\n  summarize(\n    total_new_cases = sum(new_cases, na.rm = TRUE), \n    population = unique(POPESTIMATE2021)\n  ) %&gt;%\n  mutate(new_cases_per_100k = (total_new_cases / population) * 100000) %&gt;%\n  ungroup()%&gt;%\n  glimpse()\n\nRows: 65\nColumns: 4\n$ CTYNAME            &lt;chr&gt; \"Adams County\", \"Alamosa County\", \"Arapahoe County\"…\n$ total_new_cases    &lt;int&gt; 137718, 4559, 158560, 2925, 854, 2559, 68434, 13996…\n$ population         &lt;dbl&gt; 523544, 16579, 656855, 13806, 3490, 5339, 327084, 7…\n$ new_cases_per_100k &lt;dbl&gt; 26304.95, 27498.64, 24139.27, 21186.44, 24469.91, 4…\n\n\n\ntop_5_counties &lt;- rolling_cases %&gt;%\n  arrange(desc(new_cases_per_100k)) %&gt;%\n  slice_head(n = 5) %&gt;%\n  select(county = CTYNAME, `new cases per 100k` = new_cases_per_100k) %&gt;%\n  flextable() %&gt;%\n  set_caption(\"Top 5 Counties with the Most New Cases per 100k Residents (Last 14 Days)\")\n\n\ntop_5_counties\n\ncountynew cases per 100kCrowley County58,343.50Bent County47,930.32Lincoln County40,160.79Pitkin County38,455.33Logan County35,599.35\n\n\n\nwatchlist_count &lt;- rolling_cases %&gt;%\n  filter(new_cases_per_100k &gt; 100) %&gt;%\n  nrow()\n\nprint(watchlist_count)\n\n[1] 64\n\n\nThere are 64 counties that meet the watch list condition.\nQuestion 5:\n\nlibrary(dplyr)\nlibrary(ggplot2)\n\n\ncovid_deaths_2021 &lt;- covid_pop_data %&gt;%\n  filter(format(date, \"%Y\") == \"2021\") %&gt;%\n  group_by(CTYNAME) %&gt;%\n  summarize(total_covid_deaths = sum(new_deaths, na.rm = TRUE)) %&gt;%\n  ungroup()\n\n\ncolnames(covid_pop_data)\n\n [1] \"date\"                  \"county\"                \"state\"                \n [4] \"FIPS\"                  \"cases\"                 \"deaths\"               \n [7] \"new_cases\"             \"new_deaths\"            \"STNAME\"               \n[10] \"CTYNAME\"               \"POPESTIMATE2021\"       \"NPOPCHG2021\"          \n[13] \"BIRTHS2021\"            \"DEATHS2021\"            \"NATURALCHG2021\"       \n[16] \"INTERNATIONALMIG2021\"  \"DOMESTICMIG2021\"       \"NETMIG2021\"           \n[19] \"RESIDUAL2021\"          \"GQESTIMATES2021\"       \"RBIRTH2021\"           \n[22] \"RDEATH2021\"            \"RNATURALCHG2021\"       \"RINTERNATIONALMIG2021\"\n[25] \"RDOMESTICMIG2021\"      \"RNETMIG2021\"           \"per_capita_cases\"     \n[28] \"per_capita_new_cases\"  \"per_capita_new_deaths\"\n\n\n\ncounty_deaths &lt;- left_join(covid_deaths_2021, pop_data, by = c(\"CTYNAME\" = \"CTYNAME\"))|&gt;\n  glimpse()\n\nRows: 0\nColumns: 20\n$ CTYNAME               &lt;chr&gt; \n$ total_covid_deaths    &lt;int&gt; \n$ FIPS                  &lt;chr&gt; \n$ STNAME                &lt;chr&gt; \n$ POPESTIMATE2021       &lt;dbl&gt; \n$ NPOPCHG2021           &lt;dbl&gt; \n$ BIRTHS2021            &lt;dbl&gt; \n$ DEATHS2021            &lt;dbl&gt; \n$ NATURALCHG2021        &lt;dbl&gt; \n$ INTERNATIONALMIG2021  &lt;dbl&gt; \n$ DOMESTICMIG2021       &lt;dbl&gt; \n$ NETMIG2021            &lt;dbl&gt; \n$ RESIDUAL2021          &lt;dbl&gt; \n$ GQESTIMATES2021       &lt;dbl&gt; \n$ RBIRTH2021            &lt;dbl&gt; \n$ RDEATH2021            &lt;dbl&gt; \n$ RNATURALCHG2021       &lt;dbl&gt; \n$ RINTERNATIONALMIG2021 &lt;dbl&gt; \n$ RDOMESTICMIG2021      &lt;dbl&gt; \n$ RNETMIG2021           &lt;dbl&gt; \n\n\n\ncounty_deaths &lt;- county_deaths %&gt;%\n  mutate(covid_death_percentage = (total_covid_deaths / DEATHS2021) * 100)\n\n\ncounties_above_20 &lt;- county_deaths %&gt;%\n  filter(covid_death_percentage &gt;= 20)\n\n\nggplot(counties_above_20, aes(x = reorder(CTYNAME, covid_death_percentage), y = covid_death_percentage)) +\n  geom_bar(stat = \"identity\") +\n  coord_flip() +\n  labs(\n    title = \"Counties with COVID Deaths Accounting for 20% or More of Total Deaths (2021)\",\n    x = \"County\",\n    y = \"Percentage of COVID Deaths\"\n  ) +\n  theme_minimal()\n\n\n\n\n\n\n\n\n\nsummary(county_deaths)\n\n   CTYNAME          total_covid_deaths     FIPS              STNAME         \n Length:0           Min.   : NA        Length:0           Length:0          \n Class :character   1st Qu.: NA        Class :character   Class :character  \n Mode  :character   Median : NA        Mode  :character   Mode  :character  \n                    Mean   :NaN                                             \n                    3rd Qu.: NA                                             \n                    Max.   : NA                                             \n POPESTIMATE2021  NPOPCHG2021    BIRTHS2021    DEATHS2021  NATURALCHG2021\n Min.   : NA     Min.   : NA   Min.   : NA   Min.   : NA   Min.   : NA   \n 1st Qu.: NA     1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   1st Qu.: NA   \n Median : NA     Median : NA   Median : NA   Median : NA   Median : NA   \n Mean   :NaN     Mean   :NaN   Mean   :NaN   Mean   :NaN   Mean   :NaN   \n 3rd Qu.: NA     3rd Qu.: NA   3rd Qu.: NA   3rd Qu.: NA   3rd Qu.: NA   \n Max.   : NA     Max.   : NA   Max.   : NA   Max.   : NA   Max.   : NA   \n INTERNATIONALMIG2021 DOMESTICMIG2021   NETMIG2021   RESIDUAL2021\n Min.   : NA          Min.   : NA     Min.   : NA   Min.   : NA  \n 1st Qu.: NA          1st Qu.: NA     1st Qu.: NA   1st Qu.: NA  \n Median : NA          Median : NA     Median : NA   Median : NA  \n Mean   :NaN          Mean   :NaN     Mean   :NaN   Mean   :NaN  \n 3rd Qu.: NA          3rd Qu.: NA     3rd Qu.: NA   3rd Qu.: NA  \n Max.   : NA          Max.   : NA     Max.   : NA   Max.   : NA  \n GQESTIMATES2021   RBIRTH2021    RDEATH2021  RNATURALCHG2021\n Min.   : NA     Min.   : NA   Min.   : NA   Min.   : NA    \n 1st Qu.: NA     1st Qu.: NA   1st Qu.: NA   1st Qu.: NA    \n Median : NA     Median : NA   Median : NA   Median : NA    \n Mean   :NaN     Mean   :NaN   Mean   :NaN   Mean   :NaN    \n 3rd Qu.: NA     3rd Qu.: NA   3rd Qu.: NA   3rd Qu.: NA    \n Max.   : NA     Max.   : NA   Max.   : NA   Max.   : NA    \n RINTERNATIONALMIG2021 RDOMESTICMIG2021  RNETMIG2021  covid_death_percentage\n Min.   : NA           Min.   : NA      Min.   : NA   Min.   : NA           \n 1st Qu.: NA           1st Qu.: NA      1st Qu.: NA   1st Qu.: NA           \n Median : NA           Median : NA      Median : NA   Median : NA           \n Mean   :NaN           Mean   :NaN      Mean   :NaN   Mean   :NaN           \n 3rd Qu.: NA           3rd Qu.: NA      3rd Qu.: NA   3rd Qu.: NA           \n Max.   : NA           Max.   : NA      Max.   : NA   Max.   : NA           \n\n\nQuestion 6:\n\nlibrary(tidyverse)\nlibrary(zoo)\n\nselected_states &lt;- c(\"New York\", \"Colorado\", \"Alabama\", \"Ohio\")\n\nstate_covid_data &lt;- covid |&gt; \n  filter(state %in% selected_states) |&gt;\n  group_by(state, date) |&gt;\n  summarize(daily_cases = sum(cases, na.rm = TRUE), .groups = \"drop\") |&gt; \n  arrange(state, date) |&gt; \n  group_by(state) |&gt;\n  mutate(\n    new_cases = daily_cases - lag(daily_cases, default = first(daily_cases)),  \n    rolling_mean = rollmean(new_cases, k = 7, fill = NA, align = \"center\")\n  ) |&gt; \n  ungroup()\n\n\nggplot(state_covid_data, aes(x = date, y = new_cases, fill = state)) +\n  geom_col(alpha = 0.7, show.legend = FALSE) + \n  geom_line(aes(y = rolling_mean, color = state), size = 1) +\n  facet_wrap(~ state, scales = \"free_y\") +\n  labs(title = \"Daily New COVID Cases with 7-day Rolling Average\",\n       subtitle = \"Comparison of New York, Colorado, Alabama, and Ohio\",\n       x = \"Date\", y = \"New Cases\",\n       caption = \"Data Source: NY Times COVID-19 Data\") +\n  theme_minimal()\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\nWarning: Removed 24 rows containing missing values or values outside the scale range\n(`geom_line()`).\n\n\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n`geom_line()`: Each group consists of only one observation.\nℹ Do you need to adjust the group aesthetic?\n\n\n\n\n\n\n\n\n\n\nstate_population &lt;- pop_data |&gt; \n  group_by(STNAME) |&gt;  \n  summarize(population = sum(POPESTIMATE2021, na.rm = TRUE), .groups = \"drop\")\n\n\nstate_population_filtered &lt;- state_population %&gt;%\n  filter(STNAME %in% selected_states)\n\n\nstate_covid_per_capita &lt;- state_covid_data %&gt;%\n  left_join(state_population_filtered, by = c(\"state\" = \"STNAME\")) %&gt;%\n  mutate(\n    cases_per_capita = new_cases / population,\n    rolling_per_capita = rollmean(cases_per_capita, k = 7, fill = NA, align = \"center\")\n  )\n\n\nstate_covid_per_capita &lt;- state_covid_per_capita %&gt;%\n  filter(!is.na(rolling_per_capita))\n\n\nstate_covid_per_capita$date &lt;- as.Date(state_covid_per_capita$date)\n\n\nggplot(state_covid_per_capita, aes(x = date, y = rolling_per_capita, color = state)) +\n  geom_line() +\n  labs(title = \"COVID-19 7-day Rolling Average Per Capita\")\n\n\n\n\n\n\n\n\nBriefly describe the influence scaling by population had on the analysis? Does it make some states look better? Some worse? How so?\nScaling by population impacts how the data is understood. This is because these states have very different population sizes, and we are counting cases per capita. States with larger populations may appear to have less cases than the states with smaller populations. This can potentially cause states with smaller populations to be seen as worse, even though they may have less total cases.\nQuestion 7:\n\nlibrary(readr)\n\ncounty_centroids &lt;- read_csv('https://raw.githubusercontent.com/mikejohnson51/csu-ess-330/refs/heads/main/resources/county-centroids.csv')\n\nRows: 3221 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): fips\ndbl (2): LON, LAT\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\ncovid_with_locations &lt;- covid %&gt;%\n  mutate(fips = as.character(fips)) %&gt;% \n  left_join(county_centroids, by = \"fips\")\n\n\ncovid_with_locations$date &lt;- as.Date(covid_with_locations$date)\n\n\ncovid_weighted_mean &lt;- covid_with_locations %&gt;%\n  group_by(date) %&gt;%\n  reframe(\n    weighted_lat = sum(LAT * cases, na.rm = TRUE) / sum(cases, na.rm = TRUE),\n    weighted_lon = sum(LON * cases, na.rm = TRUE) / sum(cases, na.rm = TRUE),\n    total_cases = sum(cases, na.rm = TRUE),\n    month = format(date, \"%m\")\n  ) %&gt;%\n  ungroup()\n\n\noptions(repos = c(CRAN = \"https://cloud.r-project.org/\"))\n\n\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(maps)\n\n\nAttaching package: 'maps'\n\n\nThe following object is masked from 'package:purrr':\n\n    map\n\n\n\nggplot() +\n  borders(\"state\", fill = \"gray90\", colour = \"white\") +\n  geom_point(data = covid_weighted_mean, aes(x = weighted_lon, y = weighted_lat, size = total_cases, color = month), alpha = 0.7) +\n  scale_size_continuous(name = \"Total Cases\", range = c(2, 10)) +\n  scale_color_viridis_d(name = \"Month\") +\n  theme_minimal() +\n  theme(legend.position = \"bottom\")"
  }
]